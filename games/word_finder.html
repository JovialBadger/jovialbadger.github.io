---
# Feel free to add content and custom Front Matter to this file.
# To modify the layout, see https://jekyllrb.com/docs/themes/#overriding-theme-defaults

layout: SiteMaster
nav: "1"
title: "Word Finder"
path: "Games/Word_Finder"
breadcrumbs: "1"
---
<script src="javascript/words.js?{{ site.version_number }}"></script>
<style>
	#grid-guess>div {
		display: grid;
		/*grid-template-columns: 1fr 1fr 1fr 1fr 1fr;*/
		gap: 3px;
		background-color: var(--main-color);
		padding: 3px;
		max-width:1000px;
		margin: auto;
	}

	#grid-guess>div>div, #grid-container>div {
		background-color: rgba(255, 255, 255, 0.8);
		text-align: center;
		padding: 10px 0;
		font-size: 30px;
	}
	#grid-container {
		max-width:1500px;
		margin: auto;
		display: grid;
		grid-template-columns: 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr;
		gap: 3px;
		background-color: var(--main-color);
		padding: 3px;
	}
</style>
		Word Length: <input id="inpWordLength" type="number" min="4" max="9" value="5" onblur="changeWordLength(this.value)">
		<div><span style="padding:10px;display:inline-block; background-color:#0f0;" onclick="initWordFinder()">Reset</span> <span style="float:right;padding:10px;">Wins:<span id="numberWins"></span> Losses:<span id="numberLosses"></span></span></div>
		<hr/>
		<div onclick="focusInput()">
			<div id="grid-guess"></div>
			<hr/>
			<div id="grid-container"></div>
		</div>
		<input id="inputFocus" style="height:1px;width:1px;border:none;top:0;right:0;padding:0; opacity:0;" readonly onkeyup="keyboardCapture(event)">
		<script>
			var resettable = true;
			var wordLengths = 5; //min 4 max 9
			var sucess = false;
			var chosenWord = "";
			var currentGuess = 0;
			var currentLetter = 0;
			var guessedLetters = [];
			var wins = 0;
			var losses = 0;
			const keyBoard = [{"L":"q","O":1},{"L":"w","O":2},{"L":"e","O":3},{"L":"r","O":4},{"L":"t","O":5},{"L":"y","O":6},{"L":"u","O":7},{"L":"i","O":8},{"L":"o","O":9},{"L":"p","O":10},{"L":"a","O":11},{"L":"s","O":12},{"L":"d","O":13},{"L":"f","O":14},{"L":"g","O":15},{"L":"h","O":16},{"L":"j","O":17},{"L":"k","O":18},{"L":"l","O":19},{"L":":)","O":19.5,"A":"span 2"},{"L":"z","O":20},{"L":"x","O":21},{"L":"c","O":22},{"L":"v","O":23},{"L":"b","O":24},{"L":"n","O":25},{"L":"m","O":26},{"L":"<=","O":26.5, "A":"auto / span 2"}];
			
			function focusInput(){
				getElem('inputFocus').focus();
			}
			
			function changeWordLength(val){
				val = (val * 1) || 5;
				if(resettable){
					wordLengths = val;
					initWordFinder();
				}else{
					getElem("inpWordLength").value = wordLengths;
					toastyMake("finishGameFirst");
				}
			}

			function initWordFinder() {		
				if(resettable){
					losses = getLocal("wordFinderLosses") ? getLocal("wordFinderLosses") : losses;
					wins = getLocal("wordFinderWins") ? getLocal("wordFinderWins") : wins;
					resettable = false;
					setResults();
					focusInput();
					sucess = false;
					guessedLetters = [];
					chosenWord = "";
					currentGuess = 0;
					currentLetter = 0;
					var x = words.filter(function(t) {
						return t.L == wordLengths;
					});
					x = x.concat(wordDelta.filter(function(t) {
						return t.L == wordLengths;
					}));
					//console.log(x);
					chosenWord = x[Math.floor(Math.random() * x.length)].W;
					//console.log(chosenWord);
					var y = getElem('grid-guess');
					var d = "";
					var frames = "";
					for (var a = 0; a < (wordLengths + 1); a++) {
						d += "<div id='guess-word-" + a + "'>";
						for (var b = 0; b < wordLengths; b++) {
							d += "<div class='letter-" + b + "'>&nbsp;</div>";
							if(a == 0){
								frames += " 1fr";
							}
						}
						d += "</div>";
					}
					y.innerHTML = d;
					getElem('adjustWordsTable').innerHTML = "#grid-guess>div {grid-template-columns:" + frames + ";}"
					makeKeyBoard();
				} else{
					toastyMake("finishGameFirst");
				}
			}
			
			function makeKeyBoard(){
				var wordChars = chosenWord.toUpperCase().split("");
				var z = getElem('grid-container');
				var e = "";
				for (var c = 0; c < keyBoard.length; c++) {
					var thisLetter = keyBoard[c].L.toUpperCase();
					e += "<div onclick='enterKey(\"" + thisLetter + "\")' style='" + (guessedLetters.indexOf(thisLetter) > -1 ? "background-color: " + (wordChars.indexOf(thisLetter) > -1 ? "#0f0":"#999") + ";" : "") + (keyBoard[c].A ? "grid-area:" + keyBoard[c].A + ";" : "") + "'>" + thisLetter + "</div>";
				}
				z.innerHTML = e;			
			}
			
			function keyboardCapture(e){
				var key=e.keyCode || e.which;
				switch(key){
					case 13:
						enterKey(":)");
						break;
					case 8:
						enterKey("<=");
						break;
					default:
						enterKey(String.fromCharCode(key).toUpperCase());
						break;
				}
				getElem('inputFocus').value = "";
			}
			
			function setResults(){
				getElem('numberLosses').innerHTML = losses;
				getElem('numberWins').innerHTML = wins;
				losses == 0 ? null : setLocal("wordFinderLosses", losses);
				wins == 0 ? null : setLocal("wordFinderWins", wins);
			}
			
			function enterKey(letter){
				setResults();
				var ok = false;
				var letters = keyBoard.filter(function (item) {return item.L.toUpperCase() == letter;});
				if(letters.length > 0){
					if(sucess == true){
						toastyMake("sucess, please start new game");
						return;
					}
					if(currentGuess == (wordLengths + 1)){
						toastyMake("Failed, please start new game. Word: " + chosenWord);
						return;
					}
					var elem = getElem('guess-word-' + currentGuess);
					ok = true;
					switch(letter){
						case ":)":
							if(currentLetter == wordLengths){
								var word = "";
								for (var b = 0; b < wordLengths; b++) {
									word += getClass("letter-" + b,elem)[0].innerHTML;
								}
								var x = words.filter(function(t) {
									return t.L == wordLengths;
								});
								x = x.concat(wordDelta.filter(function(t) {
									return t.L == wordLengths;
								}));
								var isWord = x.filter(function (item) {return item.W.toUpperCase() == word;});
								if(isWord.length > 0){						
									guessedLetters = guessedLetters.concat(word.split(""));
									makeKeyBoard();
									if(word == chosenWord.toUpperCase()){								
										for (var y = 0; y < wordLengths;y++) {
											getClass("letter-" + y,elem)[0].style.background = "#0f0";
										}
										sucess = true;
										wins++;
										resettable = true;
										toastyMake("correct");
									} else{			
										var wordChars = chosenWord.toUpperCase().split("");
										for (var z = 0; z < wordLengths; z++) {
											var letterElem = getClass("letter-" + z,elem)[0];
											var lettercheck = letterElem.innerHTML;
											letterElem.style.background = (wordChars[z] == lettercheck ? "#0f0" : (wordChars.indexOf(lettercheck) > -1 ? "#ff0" : ""));
										}
										if(currentGuess == wordLengths){ 
											losses++;
											resettable = true;
											toastyMake("Failed! Word: " + chosenWord);
										} else{
											toastyMake("try again");
										}
										currentGuess++;
										currentLetter = 0;
									}
								} else{
									toastyMake("no such word!");
								}
							} else{toastyMake("please fill all letters");}
							break;
						case "<=":
							currentLetter--;
							currentLetter = currentLetter < 0 ? 0 : currentLetter;
							getClass("letter-" + currentLetter,elem)[0].innerHTML = "&nbsp;";
							break;
						default:
							if(currentLetter < wordLengths){
								getClass("letter-" + currentLetter,elem)[0].innerHTML = letter;
								currentLetter++;
								currentLetter = currentLetter > wordLengths ? wordLengths : currentLetter;
							}
							break;
					}					
					setResults();
				}
			}
			docReady(function () {
				initWordFinder();
			});
		</script>
		<style id="adjustWordsTable">
		</style>